{% extends "base.html" %}
{% load static %}
{%block extra_css%}

<link rel="stylesheet" href="{% static '/css/ocplayer.min.css' %}">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
<style>
    .video-imagen > img {
        height: 100%;
        width: 78%;
    }
</style>
{%endblock%}
{% block dynamic %}
<div class="container-fluid">
    <div class="d-sm-flex justify-content-between align-items-center mb-4">
        <h3 class="text-dark mb-0">Playlist </h3>
        
        <a class="" role="" href="#"></a></div>
    <!-- <div class="row">
        <div class="col-md-12">
                <table id="playlist" class="table table-striped table-bordered" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Total Videos Assigned</th>
                            <th>Total Devices</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                    </tbody>
                    <tfoot>
                        
                    </tfoot>
                </table>
            
        </div>

        <div id="scheduleModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
        
            <div class="modal-content">
                <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        
            </div>
        </div>
    </div> -->
    
<div class="row">
    <div class="col-lg-12">
        <!--Video Player-->
        <div class="container-player">
            <div id="mediaPlayer">
                <!-- <div class="lds-ring" id=preload><div></div><div></div><div></div><div></div></div> -->
                <video id='media-video' controls>
                    <source type='video/mp4'>
                    
                </video>
                <!-- <div id="controls">
                    <button id=play><i class="fas fa-pause"></i></button>
                    <button id=audioVolume class="fas fa-volume-off"></button>
                    <div id="progressBar">
                        <div id="progress"></div>
                    </div>
                    <div id="timer">
                        <span id="start"> 0 : 00</span>
                    </div>
                    <button id=expand><i class="fas fa-expand"></i></button>
                </div> -->
            </div>
            <div id="playlist">  
            </div>
        </div>
        <!---->
    </div>
    <div class="col">
        <div class="row">
            
        </div>
    </div>
</div>
</div>
</div>
{%endblock%}

{% block extra_js %}
<!-- <script src="{% static '/js/ojcplayer.min.js' %}"></script> -->
<script>
    $(document).ready(function(){
        var response = JSON.parse(localStorage.getItem('response'));
        $.ajax({
                url: '/api/playlist/?org_uuid='+response.organization_uuid,
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                    "Access-Control-Allow-Origin": "*"
                },
                success: function(data, status){
                    var domPlayList=document.getElementById('playlist');
                    $('#mediaPlayer video source').attr('src', data[0].source);
                    data.forEach((d, idx) => {
                        // Construct card content    
                        const content = `
                                        <div id="${d.id}" class="video" onclick="trans('${d.source}');">
                                        <div class="video-imagen">
                                        <img src="${d.source}">
                                        </div>
                                        <idv class="video-information">
                                        <p></p>
                                        <span></span>
                                        </idv>
                                        </div>
                                        `;
                        // Append newyly created card element to the container
                        domPlayList.innerHTML += content;
                    });
                    
                },
                error: function(data, status, error){
                    alert(error);
                }
        });
    });
 
    function trans(source){
        $('#mediaPlayer video source').attr('src', source);
    }
</script>
{%endblock%}